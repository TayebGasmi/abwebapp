<div class="card">
  <full-calendar [options]="calendarOptions"></full-calendar>

  <p-dialog  [(visible)]="showDialog" [breakpoints]="{'960px': '75vw', '640px': '90vw'}" [style]="{width: '36rem'}" [modal]="true" [closable]="true" (onHide)="resetEvent()">
    <ng-template pTemplate="header">
      <span class="text-900 font-semibold text-xl">{{ view === 'display' ? clickedEvent?.title : view === 'new' ? 'New Event' : 'Edit Event' }}</span>
    </ng-template>

    <ng-template pTemplate="content">
      @if (view === 'display') {
        @if (clickedEvent){
          <span class="text-900 font-semibold block mb-2">Description</span>
          <span class="block mb-3">{{ clickedEvent?.extendedProps?.description }}</span>
          <div class="grid">
            <div class="col-6">
              <div class="text-900 font-semibold mb-2">Start</div>
              <p class="flex align-items-center m-0">
                <i class="pi pi-fw pi-clock text-700 mr-2"></i>
                <span>{{ clickedEvent?.start }}</span>
              </p>
            </div>
            <div class="col-6">
              <div class="text-900 font-semibold mb-2">End</div>
              <p class="flex align-items-center m-0">
                <i class="pi pi-fw pi-clock text-700 mr-2"></i>
                <span>{{ clickedEvent?.end }}</span>
              </p>
            </div>
            <div class="col-12">
              <div class="text-900 font-semibold mb-2">Location</div>
              <p class="flex align-items-center m-0">
                <i class="pi pi-fw pi-map-marker text-700 mr-2"></i>
                <span>{{ clickedEvent?.extendedProps?.location }}</span>
              </p>
            </div>
            <div class="col-12">
              <div class="text-900 font-semibold mb-2">Color</div>
              <p class="flex align-items-center m-0">
                <span class="inline-flex flex-shrink-0 w-1rem h-1rem mr-2 border-circle" [style.backgroundColor]="clickedEvent?.extendedProps?.tag.color"></span>
                <span>{{ clickedEvent?.extendedProps?.tag.name }}</span>
              </p>
            </div>
          </div>
        }

      } @else {
        <div class="grid p-fluid formgrid">
          <div class="col-12 md:col-6 field">
            <label for="title" class="text-900 font-semibold">Title</label>
            <span class="p-input-icon-left">
              <i class="pi pi-pencil"></i>
              <input id="title" type="text" pInputText placeholder="Title" formControlName="changedEvent.title" />
            </span>
          </div>
          <div class="col-12 md:col-6 field">
            <label for="location" class="text-900 font-semibold">Location</label>
            <span class="p-input-icon-left">
              <i class="pi pi-map-marker"></i>
              <input id="location" type="text" pInputText placeholder="Location" formControlName="changedEvent.extendedProps?.location" />
            </span>
          </div>
          <div class="col-12 field">
            <label for="description" class="text-900 font-semibold">Event Description</label>
            <textarea id="description" type="text" pInputTextarea [rows]="5" formControlName="changedEvent.extendedProps?.description" style="resize: none"></textarea>
          </div>
          <div class="col-12 md:col-6 field">
            <label for="startDate"  class="text-900 font-semibold">Start Date</label>
            <p-calendar id="startDate" formControlName="changedEvent.start" showIcon="true"></p-calendar>
          </div>
          <div class="col-12 md:col-6 field">
            <label for="endDate" class="text-900 font-semibold">End Date</label>
            <p-calendar id="endDate" formControlName="changedEvent.end" showIcon="true"></p-calendar>
          </div>
          <div class="col-12 md:col-6 field">
          </div>
        </div>
      }

    </ng-template>

    <ng-template pTemplate="footer">
      @if (view === 'display') {
        <button pButton label="Edit" icon="pi pi-pencil" (click)="onEditClick()" class="p-button-primary" style="margin-right: .25rem"></button>
      }
      @if (view !== 'display') {
        <button pButton label="Save" icon="pi pi-check" (click)="handleSave()" class="p-button-success"></button>
      }
      <button pButton label="Close" icon="pi pi-times" (click)="showDialog = false" class="p-button-secondary"></button>
    </ng-template>
  </p-dialog>
</div>
